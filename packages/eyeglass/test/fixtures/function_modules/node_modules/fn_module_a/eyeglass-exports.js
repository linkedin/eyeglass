"use strict";

var fs = require("fs");
var path = require("path");

module.exports = function(eyeglass, sass) {
  return {
    sassDir: __dirname, // directory where the sass files are.
    functions: {
      'hello($name: "World")': function(name, done) {
        done(new sass.types.String("Hello, " + name.getValue() + "!"));
      },
      "read($key)": function(key, done) {
        fs.readFile(path.join(__dirname, "values.json"), function(error, result) {
          if (error) {
            console.log(error);
            done(sass.types.Null.NULL);
          } else {
            var obj = JSON.parse(result);
            var rv = obj[key.getValue()];
            if (rv) {
              done(new sass.types.Number(rv));
            } else {
              done(sass.types.Null.NULL);
            }
          }
        });
      }
    }
  };
};
